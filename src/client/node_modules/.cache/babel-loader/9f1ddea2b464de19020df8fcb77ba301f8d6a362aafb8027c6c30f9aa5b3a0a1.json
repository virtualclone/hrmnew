{"ast":null,"code":"import { APIService } from '@ohrm/core/util/services/api.service';\nimport { required, validDateFormat } from '@/core/util/validation/rules';\nimport useDateFormat from '@/core/util/composable/useDateFormat';\nimport { yearRange } from '@ohrm/core/util/helper/year-range';\nimport { OxdDialog } from '@ohrm/oxd';\nimport { shouldNotExceedCharLength, maxCurrency, digitsOnlyWithTwoDecimalPoints } from '@ohrm/core/util/validation/rules';\nimport ClaimExpenseTypeDropdown from './ClaimExpenseTypeDropdown.vue';\nconst expenseModel = {\n  type: null,\n  date: null,\n  amount: null,\n  note: null\n};\nexport default {\n  name: 'SaveExpense',\n  components: {\n    'oxd-dialog': OxdDialog,\n    'claim-expense-type-dropdown': ClaimExpenseTypeDropdown\n  },\n  props: {\n    requestId: {\n      type: Number,\n      required: true\n    }\n  },\n  emits: ['close'],\n  setup(props) {\n    const http = new APIService(window.appGlobal.baseUrl, `api/v2/claim/requests/${props.requestId}/expenses`);\n    const {\n      userDateFormat\n    } = useDateFormat();\n    return {\n      http,\n      userDateFormat\n    };\n  },\n  data() {\n    return {\n      isLoading: false,\n      yearsArray: [...yearRange()],\n      expense: {\n        ...expenseModel\n      },\n      rules: {\n        type: [required],\n        date: [required, validDateFormat(this.userDateFormat)],\n        note: [shouldNotExceedCharLength(1000)],\n        amount: [required, maxCurrency(10000000000), digitsOnlyWithTwoDecimalPoints]\n      }\n    };\n  },\n  methods: {\n    onSave() {\n      this.isLoading = true;\n      this.http.create({\n        expenseTypeId: this.expense.type.id,\n        date: this.expense.date,\n        amount: Number(this.expense.amount).toFixed(2),\n        note: this.expense.note\n      }).then(() => {\n        return this.$toast.saveSuccess();\n      }).then(() => {\n        this.expense = {\n          ...expenseModel\n        };\n        this.onCancel();\n      });\n    },\n    onCancel() {\n      this.$emit('close', true);\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}