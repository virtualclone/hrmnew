{"ast":null,"code":"import { ref, computed, onBeforeMount } from 'vue';\nimport { navigate } from '@/core/util/helper/navigation';\nimport useLocale from '@/core/util/composable/useLocale';\nimport { APIService } from '@/core/util/services/api.service';\nimport { formatDate, parseDate } from '@/core/util/helper/datefns';\nimport useDateFormat from '@/core/util/composable/useDateFormat';\nimport VideoFrame from '@/orangehrmBuzzPlugin/components/VideoFrame';\nimport useBuzzAPIs from '@/orangehrmBuzzPlugin/util/composable/useBuzzAPIs';\nimport ProfileImage from '@/orangehrmBuzzPlugin/components/ProfileImage.vue';\nimport BaseWidget from '@/orangehrmDashboardPlugin/components/BaseWidget.vue';\nimport useEmployeeNameTranslate from '@/core/util/composable/useEmployeeNameTranslate';\nexport default {\n  name: 'BuzzLatestPostWidget',\n  components: {\n    'base-widget': BaseWidget,\n    'video-frame': VideoFrame,\n    'profile-image': ProfileImage\n  },\n  setup() {\n    const posts = ref([]);\n    const isLoading = ref(false);\n    const {\n      locale\n    } = useLocale();\n    const {\n      jsDateFormat,\n      jsTimeFormat\n    } = useDateFormat();\n    const {\n      $tEmpName\n    } = useEmployeeNameTranslate();\n    const {\n      fetchPosts\n    } = useBuzzAPIs(new APIService(window.appGlobal.baseUrl, ''));\n    const isEmpty = computed(() => posts.value.length === 0);\n    const onClickPost = () => navigate('/buzz/viewBuzz');\n    onBeforeMount(() => {\n      isLoading.value = true;\n      fetchPosts(5, 0, 'DESC', 'share.createdAtUtc').then(response => {\n        const {\n          data\n        } = response.data;\n        posts.value = data.map(post => {\n          const {\n            employee,\n            createdDate,\n            createdTime,\n            originalPost\n          } = post;\n          const postVideoSrc = post.video?.link || null;\n          const utcDate = parseDate(`${createdDate} ${createdTime} +00:00`, 'yyyy-MM-dd HH:mm xxx');\n          const dateTime = formatDate(utcDate, `${jsDateFormat} ${jsTimeFormat}`, {\n            locale\n          });\n          const employeeFullName = $tEmpName(employee, {\n            includeMiddle: true,\n            excludePastEmpTag: false\n          });\n          const postImgSrc = Array.isArray(post?.photoIds) ? `${window.appGlobal.baseUrl}/buzz/photo/${post.photoIds[0]}` : null;\n          const text = originalPost ? originalPost.text : post.text;\n          return {\n            ...post,\n            text,\n            dateTime,\n            postImgSrc,\n            postVideoSrc,\n            employeeFullName\n          };\n        });\n      }).finally(() => {\n        isLoading.value = false;\n      });\n    });\n    return {\n      posts,\n      isEmpty,\n      isLoading,\n      onClickPost\n    };\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}